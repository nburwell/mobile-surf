<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html class="ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8" />

	<!-- Uncomment to make IE8 render like IE7 -->
	<!-- <meta http-equiv="X-UA-Compatible" content="IE=7" /> -->

	<!-- Set the viewport width to device width for mobile -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title><%= content_for?(:title) ? yield(:title) : "MustSurfNow" %></title>

	<!-- Included CSS Files -->
	<%= stylesheet_link_tag    "application" %>

	<!-- Included JS Files  -->
	<%= javascript_include_tag "application" %>

  <%= csrf_meta_tags %>

  <script type="text/javascript">
    var locator = new Surf.Locator( <%= session[:geo].to_json.html_safe %> );

    $(document).ready(function() {
      $("#feedbackLink").click(function() {
        console.log('clicked')
        $("#feedback").reveal();
      });
    });
  </script>
</head>
<body>
  <nav class="top-bar">
    <ul>
      <li class="name"><h1><a href="/">MustSurfNow.com</a></h1></li>
      <li class="toggle-topbar"><a href="#"></a></li>
    </ul>
    <section>
      <!--<ul class="left">-->
        <!--<li><a href="#"></a></li>-->
      <!--</ul>-->

      <ul class="right">
        <li class="search">
          <form class="collapse" action="">
            <input type="text" placeholder="Address..." name="location" value="<%= %>">
            <button type="submit" class="secondary radius button">Go</button>
          </form>
        </li>
        <li><a href="#" id="feedbackLink">Feedback</a></li>
        <li><%= link_to "Meet the Team", { :controller => :team, :action => :index } %></li>
      </ul>
    </section>
  </nav>

  <div style="margin-top: .5em">
    <div class="twelve columns">
      <%# raise session[:location].inspect %>
      <% if session[:geo] %>
        <div class="alert-box" style="font-size: 1.3em">
          Location: <%= session[:geo][:name] %>
          &nbsp;
          <%= link_to "reset", { :controller => :sessions, :action => :clear }, { :style => "color: white; text-decoration: underline"} %>
          <!--<a href="" class="close">&times;</a>-->
        </div>
      <% else %>
        <div class="alert-box secondary">
          Getting your current location...
        </div>
      <% end %>
    </div>
  </div>

  <div>
    <div class="four mobile-one columns">
      <% if @spots %>
        <h5>Surf spots near you:</h5>

        <ul class="nav-bar vertical">
          <% @spots.each do |spot| %>
            <li class="has-flyout <%= 'active' if spot == @spot %>"> <!-- add "active" class -->
              <%= link_to "#{spot.name} <span class='mileage'>#{number_with_precision(spot.distance_to(session[:geo][:location], SurfSpotsController::MAX_DISTANCE), :precision => 1, :delimiter => ",")} mi</span>".html_safe,
                          { :controller => :surf_spots, :action => :show, :id => spot.id } %>
            </li>
          <% end %>
        </ul>

      <% @json = @spots.to_gmaps4rails %>
      <%= gmaps4rails(@json) %>

      <% end %>
    </div>

    <div class="eight mobile-three columns">
      <%= yield %>
    </div>
  </div>

  <div id="feedback" class="reveal-modal large">
    <h2>Give us feedback</h2>
    <p class="lead">We want your comments.</p>
    <form>
      <div class="row">
        <div class="two mobile-one columns">
          <label class="right inline">Name:</label>
        </div>
        <div class="ten mobile-three columns">
          <input type="text" placeholder="e.g. Home" class="eight" />
        </div>
      </div>
      <div class="row">
        <div class="two mobile-one columns">
          <label class="right inline">Comments:</label>
        </div>
        <div class="ten mobile-three columns">
          <textarea class="eight" rows="6"></textarea>
        </div>
      </div>
    </form>
    <a class="close-reveal-modal">&#215;</a>
  </div>

  <%= yield :scripts %>

</body>
</html>
