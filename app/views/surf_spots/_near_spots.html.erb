<% if @spots %>
  <h5>Surf spots near you:</h5>

  <ul class="nav-bar vertical">
    <% @spots.each do |spot| %>
      <li class="has-flyout <%= 'active' if spot == @spot %>"> <!-- add "active" class -->
        <%= link_to "#{spot.name} <span class='mileage'>#{number_with_precision(spot.distance_to(session[:geo][:location], SurfSpotsController::MAX_DISTANCE), :precision => 1, :delimiter => ",")} mi</span>".html_safe,
                    { :controller => :surf_spots, :action => :show, :id => spot.id } %>
      </li>
    <% end %>
  </ul>

  <% @json = @spot ? @spot.to_gmaps4rails : @spots.to_gmaps4rails %>

  <% unless @hide_gmaps %>
    <div class="map_wrapper" style="display:none">
      <%= gmaps( "markers" => { "data" => @json } ) %>
    </div>
  <% end %>
<% end %>
